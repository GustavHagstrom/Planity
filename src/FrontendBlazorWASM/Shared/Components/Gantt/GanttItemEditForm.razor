@using Planity.FrontendBlazorWASM.Shared.Abstractions
@using Planity.FrontendBlazorWASM.Shared.Models
@using MudBlazor

<MudPaper Class="pa-4" Style="width: 400px;">
    @if(Item is not null)
    {
        <MudText Typo="Typo.h6">Redigera @Item.Type.ToString()</MudText>
        <MudTextField @bind-Value="Item.Name" Label="Namn" Variant="Variant.Outlined" />
        <MudTextField @bind-Value="Item.Start" Label="Startdatum" Variant="Variant.Outlined" InputType="InputType.Date" />

        @if (Item.Predecessors != null && Item.Predecessors.Count > 0)
        {
            <MudText Typo="Typo.subtitle2">Föregångare</MudText>
            <MudList T="object">
                @foreach (var pred in Item.Predecessors)
                {
                    <MudListItem T="object">@pred.Name (@pred.Type)</MudListItem>
                }
            </MudList>
        }
        @if (Item.Successors != null && Item.Successors.Count > 0)
        {
            <MudText Typo="Typo.subtitle2">Efterföljare</MudText>
            <MudList T="object">
                @foreach (var succ in Item.Successors)
                {
                    <MudListItem T="object">@succ.Name (@succ.Type)</MudListItem>
                }
            </MudList>
        }

        @if (Item is Resource res)
        {
            <MudTextField @bind-Value="res.Workers" Label="Antal personer" Variant="Variant.Outlined" />
            <MudTextField @bind-Value="res.Efficiency" Label="Effektivitet" Variant="Variant.Outlined" />
        }
        @if (Item is ProjectTask task)
        {
            <MudTextField @bind-Value="task.WorkHours" Label="Arbetstimmar" Variant="Variant.Outlined" />
            <MudTextField @bind-Value="task.ResourceId" Label="Resurs-ID" Variant="Variant.Outlined" />
            <MudTextField @bind-Value="task.Description" Label="Beskrivning" Variant="Variant.Outlined" />
        }
        @if (Item is Milestone milestone)
        {
            <MudTextField @bind-Value="milestone.Description" Label="Beskrivning" Variant="Variant.Outlined" />
            <MudTextField Value="@milestone.ProjectId.ToString()" Label="Projekt-ID" Variant="Variant.Outlined" Disabled="true" />
        }
        @if (Item is Project project)
        {
            <MudTextField @bind-Value="project.Description" Label="Beskrivning" Variant="Variant.Outlined" />
            <MudText Typo="Typo.subtitle2">Tasks</MudText>
            <MudList T="ProjectTask">
                @foreach (var t in project.Tasks)
                {
                    <MudListItem Value="t">@t.Name (@t.Type)</MudListItem>
                }
            </MudList>
            <MudText Typo="Typo.subtitle2">Milestones</MudText>
            <MudList T="Milestone">
                @foreach (var m in project.Milestones)
                {
                    <MudListItem Value="m">@m.Name (@m.Type)</MudListItem>
                }
            </MudList>
        }
    }
</MudPaper>

@code {
    [Parameter] public IGanttItem? Item { get; set; }
}
