@inject IStringLocalizer<WorkDayFormDialog> localizer

<MudDialog>
    <TitleContent>
        @localizer["Arbetspass"]
    </TitleContent>
    <DialogContent>
        <MudStack Spacing="2">
            <MudSelect T="DayOfWeek" @bind-Value="@Day" Label="Day" ToStringFunc="WeekDayToString" Variant="Variant.Outlined" Margin="Margin.Dense">
                <MudSelectItem Value="DayOfWeek.Monday" />
                <MudSelectItem Value="DayOfWeek.Tuesday" />
                <MudSelectItem Value="DayOfWeek.Wednesday" />
                <MudSelectItem Value="DayOfWeek.Thursday" />
                <MudSelectItem Value="DayOfWeek.Friday" />
                <MudSelectItem Value="DayOfWeek.Saturday" />
                <MudSelectItem Value="DayOfWeek.Sunday" />
            </MudSelect>
            <MudTimePicker Margin="Margin.Dense" @bind-Time="Start" Required="true" Label="@localizer["Start"]" />
            <MudTimePicker Margin="Margin.Dense" @bind-Time="End" Required="true" Label="@localizer["Slut"]" />
            <PlanityTextField T="double" Label="@localizer["Rast"]" @bind-Value="BreakDuration" Adornment="Adornment.Start" AdornmentText="@localizer["Timmar"]" />
        </MudStack>
    </DialogContent>
    <DialogActions>
        <MudButton Variant="Variant.Text" Color="Color.Primary">@localizer["Avbryt"]</MudButton>
        <MudButton Variant="Variant.Filled" Color="Color.Primary"  Disabled="@(Period?.Start == null || Period?.End == null)" OnClick="Submit" StartIcon="@Icons.Material.Sharp.Save">@localizer["Spara"]</MudButton>
    </DialogActions>
   
</MudDialog>


@code {
    [CascadingParameter] IMudDialogInstance MudDialog { get; set; } = default!;
    [Parameter] public WorkPeriod? Period { get; set; }
    DayOfWeek Day;
    TimeSpan? Start;
    TimeSpan? End;
    double BreakDuration = 1;

    protected override void OnInitialized()
    {
        if(Period is not null)
        {
            Day = Period.Day;
            Start = Period.Start;
            End = Period.End;
            BreakDuration = Period.BreakDuration;
        }
    }


    string WeekDayToString(DayOfWeek dayOfWeek)
    {
        return dayOfWeek switch
        {
            DayOfWeek.Monday => localizer["Måndag"],
            DayOfWeek.Tuesday => localizer["Tisdag"],
            DayOfWeek.Wednesday => localizer["Onsdag"],
            DayOfWeek.Thursday => localizer["Torsdag"],
            DayOfWeek.Friday => localizer["Fredag"],
            DayOfWeek.Saturday => localizer["Lördag"],
            DayOfWeek.Sunday => localizer["Söndag"],
            _ => string.Empty,
        };
    }

    void Submit()
    {
        if (MudDialog is not null && Start is not null && End is not null)
        {
            MudDialog.Close(DialogResult.Ok(new WorkPeriod
            {
                Day = Day,
                Start = Start.Value,
                End = End.Value,
                BreakDuration = BreakDuration
            }));
        }
    }

}