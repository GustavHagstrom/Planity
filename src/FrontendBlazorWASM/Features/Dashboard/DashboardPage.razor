@page "/"
@layout FullHeightLayout
@using Planity.FrontendBlazorWASM.Shared.Components.Gantt
@inject IProjectService ProjectService
@inject IResourceService ResourceService

<PageTitle>Dashboard</PageTitle>

<GanttView StartParam="DateTime.Today" EndParam="DateTime.Today.AddDays(60)" Items="projects" Mode="GanttViewMode.Week" Zoom="0.5" Title="Veckovy"/>


@code{
    List<Project> projects = new List<Project>();
    Resource testResource = null!;
    List<ProjectTask> testResourceTasks = new List<ProjectTask>();

    string testResourceTitle => $"Tasks for resource {testResource.Name}";
    protected override async Task OnInitializedAsync()
    {
        var projects = await ProjectService.GetProjectsAsync();
        if (projects is not null)
        {
            this.projects = projects.ToList();
        }
        var resources = await ResourceService.GetResourcesAsync();
        if (resources is not null)
        {
            testResource = resources.First();
        }
        testResourceTasks = await ResourceService.GetTasksForResourceAsync(testResource.Id);
    }
}