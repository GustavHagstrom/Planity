@page "/"
@layout FullHeightLayout
@using Planity.FrontendBlazorWASM.Shared.Components.Gantt
@inject IProjectService ProjectService
@inject IResourceService ResourceService
@inject ITaskService TaskService

<PageTitle>Dashboard</PageTitle>

<GanttView StartParam="DateTime.Today" EndParam="DateTime.Today.AddDays(60)" ItemsParam="projects" LinksParam="[]" Mode="GanttViewMode.Week" Title="Veckovy"/>


@code{
    List<Project> projects = new List<Project>();
    Resource testResource = null!;
    List<ProjectTask> testResourceTasks = new List<ProjectTask>();

    string testResourceTitle => $"Tasks for resource {testResource.Name}";
    protected override async Task OnInitializedAsync()
    {
        var projects = await ProjectService.GetAllAsync();
        if (projects is not null)
        {
            this.projects = projects.ToList();
        }
        var resources = await ResourceService.GetAllAsync();
        if (resources is not null)
        {
            testResource = resources.First();
        }
        testResourceTasks = await TaskService.GetFromResourceIdAsync(testResource.Id);
    }
}